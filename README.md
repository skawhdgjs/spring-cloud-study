# spring-cloud-study

## 마이크로 서비스

장점: 확장성, 유연성, 독립적 배포성 
단점: Tool 로써 해결

1 스프링 클라우드 기반의 클라우드 네이티브 개발

2 마이크로서비스 기반 아키텍처에서 중요한 요소

3 서비스 간의 통신 모델

4 서킷 브레이커 및 폴백 패턴

---


마이크로 서비스

*IT 시스템 아키텍처*

비지니스 요구사항을 구현한 하나의 애플리케이션을 느슨하게 연결된 여러 애플리케이션 으로 쪼갠다.
=> 즉 하나의 "비지니스"를 느슨한 관게로 쪼개는 아키텍쳐 방식
=> **서비스 기반 아키텍쳐** 개념의 다른 형태

가장 주요한 해택

"대규모" 애플리케이션을 seamless 하게 배포 가능

장점
1. 소스 코드 규모가 상대적으로 작음 , domain 이해가 쉬움, 따라서 코드의 품질을 유지하기 쉬움
2. 분리 <> 서브 시스템을 만들 필요가 없음

---

스프링 프레임워크로 마이크로 서비스 만들기

마이크로 서비스

버텍스, 아파치카멜 <<< 스프링 프레임 워크

스프링 클라우드는 
서비스 레지스트리, 컨피규레이션 서버, 서킷 브레이커, 클라우드 버스, Oauth2 패턴, API 게이트웨이 
같은 마이크로서비스 기반 아키텍처에서 사용되는 모든 검증된 패턴을 구현

---

클라우드 네이티브 개발

마이크로 서비스 < 클라우드 컴퓨팅 < 유연한 scale in, out, 배포용이성 < 확장성, 신뢰성, 낮은 유지보수 비용 제공 < 시간과 비용 절감

`*네이티브 클라우드 애플리이션* 단순히 클라우드로 이전한 프로그램이 아니라 클라우드 환경울 위해 잘 설계된 프로그램이다.`

별첨) 스프링은 클라우드 네이티브 개발을 잘 도와준다. 이걸로 개발된 프로그램은 클라우드 및 도커 상 쉽게 배포 가능, 또한
기존 방식에서도 마이크로 서비스 잠점을 만들 수 있다.

---
마이크로 서비스 아키텍쳐

1. 각 business domain 별로 데이터와 로직을 가짐
2. 복잡해지는 구성을 API 게이트웨어로 숨김
3. 시스템 디스커버리를 통해 모든 요청을 동적으로 전달 
 
---

서비스 디스커버리의 필요성 이해하기

서비스 디서커버리 : 컴퓨터 네트워크상의 디바이스가 제공하는 디바이스와 서비를 자동으로 감지하는 중앙 서비스

중앙 저장소에 자신을 등록하고 다른 인스턴스의 변경사항을 알 수 있음, ( 하나의 키에 여러 인스턴스가 등록 가능) 
서비스 디스커버리를 서버 컨피규레이션 기능과 함꼐 사용 ( git 또는 컨설과 주키퍼 등이 있음 )

----

서비스 간 통신

( 고신뢰 성을 보장 하기 위해 여러 개 인선턴스와 부하 분산을 적용해야 한다)

상호 작용 스타일

일대 일/ 일대다 통신
동기 / 비동기 방식 ( 더 나아가 리액티브 마이크로 서비스 )
publish/subscribe 방식 ( kafka, MQ, 액티브 엠큐 ) 

----
장애와 서킷 브레이커 
 
후속 후촐이 많은 마이크로 서비스에서 장애는 심각  

방안
1. 타임아웃
 - 응답 시간을 기다리는 것보단 에러를 전파 하는게 낫다.
2. 서킷 브레이커 
 - 타임아웃 이용, 요청 성공/실패를 확률적으로 계산해 차단후 무조건 에러처리, 이후 일정시간후 다시 시도
 - 느린 인스턴스는 분산 부하 처리시 무시
3. 폴백 
 - 요청이 실패 했을때 오류가 아닌 기본값등으로 반환 (오류 감지가 늦을 수 있음)
 
---

스프링 클라우드 장점 

모든 패턴과 매커니즘 지원 , 안정적으로 구현 
  
